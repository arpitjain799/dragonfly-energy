<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dragonfly_energy.opendss.network &#8212; dragonfly-energy  documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          dragonfly-energy</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cli/index.html">CLI Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cli/index.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cli/index.html#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cli/translate.html">translate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cli/translate.html#dragonfly-energy-translate">dragonfly-energy translate</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../cli/translate.html#dragonfly-energy-translate-model-to-gbxml">model-to-gbxml</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../cli/translate.html#dragonfly-energy-translate-model-to-idf">model-to-idf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../cli/translate.html#dragonfly-energy-translate-model-to-osm">model-to-osm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cli/simulate.html">simulate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cli/simulate.html#dragonfly-energy-simulate">dragonfly-energy simulate</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../cli/simulate.html#dragonfly-energy-simulate-model">model</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">dragonfly_energy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dragonfly_energy.html">dragonfly_energy package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dragonfly_energy.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.cli.html">dragonfly_energy.cli package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.cli.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.cli.simulate.html">dragonfly_energy.cli.simulate module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.cli.translate.html">dragonfly_energy.cli.translate module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.cli.html#module-dragonfly_energy.cli">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.des.html">dragonfly_energy.des package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.des.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.des.connector.html">dragonfly_energy.des.connector module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.des.ghe.html">dragonfly_energy.des.ghe module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.des.junction.html">dragonfly_energy.des.junction module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.des.loop.html">dragonfly_energy.des.loop module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.des.html#module-dragonfly_energy.des">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.opendss.html">dragonfly_energy.opendss package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.opendss.html#subpackages">Subpackages</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.lib.html">dragonfly_energy.opendss.lib package</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../dragonfly_energy.opendss.lib.html#submodules">Submodules</a><ul>
<li class="toctree-l8"><a class="reference internal" href="../../../dragonfly_energy.opendss.lib.powerlines.html">dragonfly_energy.opendss.lib.powerlines module</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../dragonfly_energy.opendss.lib.transformers.html">dragonfly_energy.opendss.lib.transformers module</a></li>
<li class="toctree-l8"><a class="reference internal" href="../../../dragonfly_energy.opendss.lib.wires.html">dragonfly_energy.opendss.lib.wires module</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="../../../dragonfly_energy.opendss.lib.html#module-dragonfly_energy.opendss.lib">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.opendss.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.colorobj.html">dragonfly_energy.opendss.colorobj module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.connector.html">dragonfly_energy.opendss.connector module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.junction.html">dragonfly_energy.opendss.junction module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.network.html">dragonfly_energy.opendss.network module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.powerline.html">dragonfly_energy.opendss.powerline module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.result.html">dragonfly_energy.opendss.result module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.road.html">dragonfly_energy.opendss.road module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.substation.html">dragonfly_energy.opendss.substation module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.transformer.html">dragonfly_energy.opendss.transformer module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.transformerprop.html">dragonfly_energy.opendss.transformerprop module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.opendss.wire.html">dragonfly_energy.opendss.wire module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.opendss.html#module-dragonfly_energy.opendss">Module contents</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.properties.html">dragonfly_energy.properties package</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.properties.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.properties.building.html">dragonfly_energy.properties.building module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.properties.context.html">dragonfly_energy.properties.context module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.properties.model.html">dragonfly_energy.properties.model module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.properties.room2d.html">dragonfly_energy.properties.room2d module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../dragonfly_energy.properties.story.html">dragonfly_energy.properties.story module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../dragonfly_energy.properties.html#module-dragonfly_energy.properties">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dragonfly_energy.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.config.html">dragonfly_energy.config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.measure.html">dragonfly_energy.measure module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.reopt.html">dragonfly_energy.reopt module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.run.html">dragonfly_energy.run module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dragonfly_energy.writer.html">dragonfly_energy.writer module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dragonfly_energy.html#module-dragonfly_energy">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cli/index.html">CLI Docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">dragonfly_energy</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-4">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cli/index.html">CLI Docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">dragonfly_energy</a></li>
</ul>

        </div>
      </div>
    <div class="body col-md-8 content" role="main">
      
  <h1>Source code for dragonfly_energy.opendss.network</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding=utf-8</span>
<span class="sd">&quot;&quot;&quot;Electrical network in OpenDSS.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">ladybug_geometry.geometry2d</span> <span class="kn">import</span> <span class="n">Point2D</span><span class="p">,</span> <span class="n">Polygon2D</span>
<span class="kn">from</span> <span class="nn">ladybug.location</span> <span class="kn">import</span> <span class="n">Location</span>
<span class="kn">from</span> <span class="nn">honeybee.typing</span> <span class="kn">import</span> <span class="n">valid_ep_string</span>
<span class="kn">from</span> <span class="nn">honeybee.units</span> <span class="kn">import</span> <span class="n">conversion_factor_to_meters</span>
<span class="kn">from</span> <span class="nn">dragonfly.projection</span> <span class="kn">import</span> <span class="n">meters_to_long_lat_factors</span><span class="p">,</span> \
    <span class="n">origin_long_lat_from_location</span>

<span class="kn">from</span> <span class="nn">.substation</span> <span class="kn">import</span> <span class="n">Substation</span>
<span class="kn">from</span> <span class="nn">.transformer</span> <span class="kn">import</span> <span class="n">Transformer</span>
<span class="kn">from</span> <span class="nn">.connector</span> <span class="kn">import</span> <span class="n">ElectricalConnector</span>
<span class="kn">from</span> <span class="nn">.junction</span> <span class="kn">import</span> <span class="n">ElectricalJunction</span>
<span class="kn">from</span> <span class="nn">.road</span> <span class="kn">import</span> <span class="n">Road</span>
<span class="kn">from</span> <span class="nn">.transformerprop</span> <span class="kn">import</span> <span class="n">TransformerProperties</span>
<span class="kn">from</span> <span class="nn">.powerline</span> <span class="kn">import</span> <span class="n">PowerLine</span>
<span class="kn">from</span> <span class="nn">.wire</span> <span class="kn">import</span> <span class="n">Wire</span>
<span class="kn">from</span> <span class="nn">.lib.powerlines</span> <span class="kn">import</span> <span class="n">power_line_by_identifier</span>


<div class="viewcode-block" id="ElectricalNetwork"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork">[docs]</a><span class="k">class</span> <span class="nc">ElectricalNetwork</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an electrical network in OpenDSS.</span>

<span class="sd">    This includes a substation, transformers, and all electrical connectors needed</span>
<span class="sd">    to connect these objects to Dragonfly Buildings.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier: Text string for a unique electrical network ID. Must contain only</span>
<span class="sd">            characters that are acceptable in OpenDSS. This will be used to</span>
<span class="sd">            identify the object across the exported geoJSON and OpenDSS files.</span>
<span class="sd">        substation: A Substation object representing the electrical substation</span>
<span class="sd">            supplying the network with electricity.</span>
<span class="sd">        transformers: An array of Transformer objects that are included within the</span>
<span class="sd">            electrical network. Generally, there should always be a transformer</span>
<span class="sd">            somewhere between the substation and a given building.</span>
<span class="sd">        connectors: An array of ElectricalConnector objects that are included</span>
<span class="sd">            within the electrical network. In order for a given connector to be</span>
<span class="sd">            valid within the network, each end of the connector must touch either</span>
<span class="sd">            another connector or a building footprint/transformer/substation. In</span>
<span class="sd">            order for the network as a whole to be valid, all Buildings and</span>
<span class="sd">            Transformers must be connected back to the Substation via connectors.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * identifier</span>
<span class="sd">        * display_name</span>
<span class="sd">        * substation</span>
<span class="sd">        * transformers</span>
<span class="sd">        * connectors</span>
<span class="sd">        * transformer_properties</span>
<span class="sd">        * power_lines</span>
<span class="sd">        * wires</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;_display_name&#39;</span><span class="p">,</span> <span class="s1">&#39;_substation&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;_transformers&#39;</span><span class="p">,</span> <span class="s1">&#39;_connectors&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">substation</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span> <span class="n">connectors</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize ElectricalNetwork.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substation</span> <span class="o">=</span> <span class="n">substation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span> <span class="o">=</span> <span class="n">transformers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span> <span class="o">=</span> <span class="n">connectors</span>

<div class="viewcode-block" id="ElectricalNetwork.from_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize an ElectricalNetwork from a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: A dictionary representation of an ElectricalNetwork object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the type of dictionary</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ElectricalNetwork&#39;</span><span class="p">,</span> <span class="s1">&#39;Expected ElectricalNetwork &#39;</span> \
            <span class="s1">&#39;dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="c1"># re-serialize transformer properties and wires</span>
        <span class="n">t_props</span> <span class="o">=</span> <span class="p">{</span><span class="n">tp</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]:</span> <span class="n">TransformerProperties</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;transformer_properties&#39;</span><span class="p">]}</span>
        <span class="n">wires</span> <span class="o">=</span> <span class="p">{</span><span class="n">w</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]:</span> <span class="n">Wire</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wires&#39;</span><span class="p">]}</span>
        <span class="n">power_lines</span> <span class="o">=</span> <span class="p">{</span><span class="n">pl</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]:</span> <span class="n">PowerLine</span><span class="o">.</span><span class="n">from_dict_abridged</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">wires</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">pl</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;power_lines&#39;</span><span class="p">]}</span>
        <span class="c1"># re-serialize geometry objects</span>
        <span class="n">substation</span> <span class="o">=</span> <span class="n">Substation</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;substation&#39;</span><span class="p">])</span>
        <span class="n">transformers</span> <span class="o">=</span> <span class="p">[</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_dict_abridged</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span> <span class="n">t_props</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">trans</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;transformers&#39;</span><span class="p">]]</span>
        <span class="n">conns</span> <span class="o">=</span> <span class="p">[</span><span class="n">ElectricalConnector</span><span class="o">.</span><span class="n">from_dict_abridged</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">power_lines</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;connectors&#39;</span><span class="p">]]</span>
        <span class="n">net</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">],</span> <span class="n">substation</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span> <span class="n">conns</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;display_name&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">net</span></div>

<div class="viewcode-block" id="ElectricalNetwork.from_rnm_geojson"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.from_rnm_geojson">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_rnm_geojson</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">geojson_file_path</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;Meters&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get an ElectricalNetwork from a dictionary as it appears in an RNM GeoJSON.</span>

<span class="sd">        Args:</span>
<span class="sd">            geojson_file_path: Text for the full path to the geojson file to load</span>
<span class="sd">                as a ElectricalNetwork.</span>
<span class="sd">            location: An optional ladybug location object with longitude and</span>
<span class="sd">                latitude data defining the origin of the geojson file. If None,</span>
<span class="sd">                an attempt will be made to sense the location from the project</span>
<span class="sd">                point in the GeoJSON (if it exists). If nothing is found, the</span>
<span class="sd">                origin is autocalcualted as the bottom-left corner of the bounding</span>
<span class="sd">                box of all building footprints in the geojson file. (Default: None).</span>
<span class="sd">            point: A ladybug_geometry Point2D for where the location object exists</span>
<span class="sd">                within the space of a scene. The coordinates of this point are</span>
<span class="sd">                expected to be in the units input. If None, an attempt will be</span>
<span class="sd">                made to sense the CAD coordinates from the GeoJSON if they</span>
<span class="sd">                exist. If not found, they will default to (0, 0).</span>
<span class="sd">            units: Text for the units system in which the model geometry</span>
<span class="sd">                exists. Default: &#39;Meters&#39;. Choose from the following:</span>

<span class="sd">                * Meters</span>
<span class="sd">                * Millimeters</span>
<span class="sd">                * Feet</span>
<span class="sd">                * Inches</span>
<span class="sd">                * Centimeters</span>

<span class="sd">                Note that this method assumes the point coordinates are in the</span>
<span class="sd">                same units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># parse the geoJSON into a dictionary</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">geojson_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

        <span class="c1"># extract the CAD coordinates and location from the GeoJSON if they exist</span>
        <span class="k">if</span> <span class="s1">&#39;project&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">prd</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">prd</span> <span class="ow">and</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="n">prd</span> <span class="ow">and</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">Location</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">prd</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">longitude</span><span class="o">=</span><span class="n">prd</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;cad_coordinates&#39;</span> <span class="ow">in</span> <span class="n">prd</span> <span class="ow">and</span> <span class="n">point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">point</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">(</span><span class="o">*</span><span class="n">prd</span><span class="p">[</span><span class="s1">&#39;cad_coordinates&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># just use the world origin if no point was found</span>
            <span class="n">point</span> <span class="o">=</span> <span class="n">Point2D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Get the list of substation, transformer and electrical connector data</span>
        <span class="n">transf_data</span><span class="p">,</span> <span class="n">connector_data</span><span class="p">,</span> <span class="n">subst_data</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">obj_data</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">obj_data</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">obj_data</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Line&#39;</span><span class="p">:</span>
                    <span class="n">connector_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">obj_data</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DistribTransf&#39;</span><span class="p">:</span>
                    <span class="n">transf_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;Substation&#39;</span> <span class="ow">in</span> <span class="n">obj_data</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]:</span>
                    <span class="n">subst_data</span> <span class="o">=</span> <span class="n">obj_data</span>

        <span class="c1"># if model units is not Meters, convert non-meter user inputs to meters</span>
        <span class="n">scale_to_meters</span> <span class="o">=</span> <span class="n">conversion_factor_to_meters</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">!=</span> <span class="s1">&#39;Meters&#39;</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale_to_meters</span><span class="p">)</span>

        <span class="c1"># Get long and lat in the geojson that correspond to the model origin (point).</span>
        <span class="c1"># If location is None, derive coordinates from the geojson geometry.</span>
        <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">point_lon_lat</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_bottom_left_coordinate_from_geojson</span><span class="p">(</span><span class="n">connector_data</span><span class="p">)</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">Location</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">point_lon_lat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">latitude</span><span class="o">=</span><span class="n">point_lon_lat</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># The model point may not be at (0, 0), so shift the longitude and latitude to</span>
        <span class="c1"># get the equivalent point in longitude and latitude for (0, 0) in the model.</span>
        <span class="n">origin_lon_lat</span> <span class="o">=</span> <span class="n">origin_long_lat_from_location</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
        <span class="n">_convert_facs</span> <span class="o">=</span> <span class="n">meters_to_long_lat_factors</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">)</span>
        <span class="n">convert_facs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">_convert_facs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">_convert_facs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># extract the connectors</span>
        <span class="n">power_line_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">p</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;Equip&#39;</span><span class="p">]:</span> <span class="n">power_line_by_identifier</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;Equip&#39;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">connector_data</span>
        <span class="p">}</span>
        <span class="n">connectors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">con_data</span> <span class="ow">in</span> <span class="n">connector_data</span><span class="p">:</span>
            <span class="n">con_obj</span> <span class="o">=</span> <span class="n">ElectricalConnector</span><span class="o">.</span><span class="n">from_rnm_geojson_dict</span><span class="p">(</span>
                <span class="n">con_data</span><span class="p">,</span> <span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">,</span> <span class="n">power_line_dict</span><span class="p">)</span>
            <span class="n">connectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">con_obj</span><span class="p">)</span>
        <span class="c1"># extract the transformers</span>
        <span class="n">transformers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">trn_data</span> <span class="ow">in</span> <span class="n">transf_data</span><span class="p">:</span>
            <span class="n">trn_obj</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_rnm_geojson_dict</span><span class="p">(</span>
                <span class="n">trn_data</span><span class="p">,</span> <span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">)</span>
            <span class="n">transformers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trn_obj</span><span class="p">)</span>
        <span class="c1"># extract the substation</span>
        <span class="n">substation</span> <span class="o">=</span> <span class="n">Substation</span><span class="o">.</span><span class="n">from_rnm_geojson_dict</span><span class="p">(</span>
            <span class="n">subst_data</span><span class="p">,</span> <span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">)</span>

        <span class="c1"># create the network and adjust for the units</span>
        <span class="n">base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">geojson_file_path</span><span class="p">)</span>
        <span class="n">net_id</span> <span class="o">=</span> <span class="n">base_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.json&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.geojson&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">net</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">net_id</span><span class="p">,</span> <span class="n">substation</span><span class="p">,</span> <span class="n">transformers</span><span class="p">,</span> <span class="n">connectors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">!=</span> <span class="s1">&#39;Meters&#39;</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">convert_to_units</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">net</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_bottom_left_coordinate_from_geojson</span><span class="p">(</span><span class="n">connector_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the bottom-left bounding box coordinate from geojson coordinates.</span>

<span class="sd">        Args:</span>
<span class="sd">            connector_data: a list of dictionaries containing geojson geometries that</span>
<span class="sd">                represent electrical connectors.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The bottom-left most corner of the bounding box around the coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="n">connector_data</span><span class="p">:</span>
            <span class="n">conn_coords</span> <span class="o">=</span> <span class="n">conn</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">][</span><span class="s1">&#39;coordinates&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">conn</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;LineString&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">conn_coords</span><span class="p">:</span>
                    <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set the text string for unique object identifier.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>

    <span class="nd">@identifier</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="n">valid_ep_string</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set a string for the object name without any character restrictions.</span>

<span class="sd">        If not set, this will be equal to the identifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span>

    <span class="nd">@display_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>  <span class="c1"># Python 2 machine lacking the character set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># keep it as unicode</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">substation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set a Substation object for the network&#39;s substation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span>

    <span class="nd">@substation</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">substation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Substation</span><span class="p">),</span> \
            <span class="s1">&#39;Expected Substation for electrical network. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transformers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set the list of Transformer objects within the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformers</span>

    <span class="nd">@transformers</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">transformers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected list or tuple for electrical network &#39;</span>
                            <span class="s1">&#39;transformers. Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Transformer</span><span class="p">),</span> <span class="s1">&#39;Expected Transformer object&#39;</span> \
                <span class="s1">&#39; for electrical network transformers. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transformers</span> <span class="o">=</span> <span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">connectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set the list of ElectricalConnector objects within the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connectors</span>

    <span class="nd">@connectors</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">connectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected list or tuple for electrical network connectors. &#39;</span>
                            <span class="s1">&#39;Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ElectricalConnector</span><span class="p">),</span> <span class="s1">&#39;Expected ElectricalConnector &#39;</span> \
                <span class="s1">&#39;object for electrical network connectors. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ElectricalNetwork must possess at least one connector.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connectors</span> <span class="o">=</span> <span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transformer_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of all unique TransformerProperties in the network.&quot;&quot;&quot;</span>
        <span class="n">t_props</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">trans</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_in_array</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">properties</span><span class="p">,</span> <span class="n">t_props</span><span class="p">):</span>
                <span class="n">t_props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">t_props</span><span class="p">))</span>  <span class="c1"># catch duplicated/equivalent objects</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">power_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of all unique PowerLines in the network.&quot;&quot;&quot;</span>
        <span class="n">power_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_in_array</span><span class="p">(</span><span class="n">connector</span><span class="o">.</span><span class="n">power_line</span><span class="p">,</span> <span class="n">power_lines</span><span class="p">):</span>
                <span class="n">power_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connector</span><span class="o">.</span><span class="n">power_line</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">power_lines</span><span class="p">))</span>  <span class="c1"># catch duplicated/equivalent objects</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">wires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list of all unique Wires in the network.&quot;&quot;&quot;</span>
        <span class="n">wires</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p_line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_lines</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="n">p_line</span><span class="o">.</span><span class="n">wires</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instance_in_array</span><span class="p">(</span><span class="n">wire</span><span class="p">,</span> <span class="n">wires</span><span class="p">):</span>
                    <span class="n">wires</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wire</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">wires</span><span class="p">))</span>  <span class="c1"># catch duplicated/equivalent objects</span>

<div class="viewcode-block" id="ElectricalNetwork.junctions"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.junctions">[docs]</a>    <span class="k">def</span> <span class="nf">junctions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of ElectricalJunction objects for the unique network junctions.</span>

<span class="sd">        The resulting ElectricalJunction objects will be associated with Transformers</span>
<span class="sd">        and Substations that they are in contact with across the network (within</span>
<span class="sd">        the tolerance). However, they won&#39;t have any building_identifier associated</span>
<span class="sd">        with them. The assign_junction_buildings method on this object can be used</span>
<span class="sd">        to associate the junctions with an array of Dragonfly Buildings.</span>

<span class="sd">        Args:</span>
<span class="sd">            tolerance: The minimum difference between the coordinate values of two</span>
<span class="sd">                faces at which they can be considered centered adjacent. (Default: 0.01,</span>
<span class="sd">                suitable for objects in meters).</span>

<span class="sd">        Returns:</span>
<span class="sd">             A tuple with two items.</span>

<span class="sd">            -   junctions - A list of lists of the unique ElectricalJunction objects</span>
<span class="sd">                that exist across the network.</span>

<span class="sd">            -   connector_junction_ids - A list of lists that align with the connectors</span>
<span class="sd">                in the network. Each sub-list contains two string values for the junction</span>
<span class="sd">                IDs for each of the start and end of each of the connectors.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># loop through the connectors and find all unique junction objects</span>
        <span class="n">junctions</span><span class="p">,</span> <span class="n">connector_junction_ids</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">:</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="n">connector</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">vertices</span>
            <span class="n">end_pts</span><span class="p">,</span> <span class="n">jct_ids</span> <span class="o">=</span> <span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">verts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">jct_pt</span> <span class="ow">in</span> <span class="n">end_pts</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">exist_jct</span> <span class="ow">in</span> <span class="n">junctions</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jct_pt</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">exist_jct</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">):</span>
                        <span class="n">jct_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exist_jct</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># we have found a new unique junction</span>
                    <span class="n">new_jct_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
                    <span class="n">junctions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ElectricalJunction</span><span class="p">(</span><span class="n">new_jct_id</span><span class="p">,</span> <span class="n">jct_pt</span><span class="p">))</span>
                    <span class="n">jct_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_jct_id</span><span class="p">)</span>
            <span class="n">connector_junction_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jct_ids</span><span class="p">)</span>

        <span class="c1"># loop through connectors and associate them with Transformers or the Substation</span>
        <span class="n">all_ds_objs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="p">,)</span>
        <span class="k">for</span> <span class="n">jct</span> <span class="ow">in</span> <span class="n">junctions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ds_obj</span> <span class="ow">in</span> <span class="n">all_ds_objs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ds_obj</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">is_point_on_edge</span><span class="p">(</span><span class="n">jct</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">):</span>
                    <span class="n">jct</span><span class="o">.</span><span class="n">system_identifier</span> <span class="o">=</span> <span class="n">ds_obj</span><span class="o">.</span><span class="n">identifier</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">junctions</span><span class="p">,</span> <span class="n">connector_junction_ids</span></div>

<div class="viewcode-block" id="ElectricalNetwork.move"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moving_vec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move this object along a vector.</span>

<span class="sd">        Args:</span>
<span class="sd">            moving_vec: A ladybug_geometry Vector3D with the direction and distance</span>
<span class="sd">                to move the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moving_vec</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">:</span>
            <span class="n">transformer</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moving_vec</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">:</span>
            <span class="n">connector</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moving_vec</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElectricalNetwork.rotate_xy"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.rotate_xy">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotate this object counterclockwise in the XY plane by a certain angle.</span>

<span class="sd">        Args:</span>
<span class="sd">            angle: An angle in degrees.</span>
<span class="sd">            origin: A ladybug_geometry Point3D for the origin around which the</span>
<span class="sd">                object will be rotated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">:</span>
            <span class="n">transformer</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">:</span>
            <span class="n">connector</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElectricalNetwork.reflect"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.reflect">[docs]</a>    <span class="k">def</span> <span class="nf">reflect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plane</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reflect this object across a plane.</span>

<span class="sd">        Args:</span>
<span class="sd">            plane: A ladybug_geometry Plane across which the object will be reflected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">plane</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">:</span>
            <span class="n">transformer</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">plane</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">:</span>
            <span class="n">connector</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">plane</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElectricalNetwork.scale"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scale this object by a factor from an origin point.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">            origin: A ladybug_geometry Point3D representing the origin from which</span>
<span class="sd">                to scale. If None, it will be scaled from the World origin (0, 0, 0).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">:</span>
            <span class="n">transformer</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">:</span>
            <span class="n">connector</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElectricalNetwork.convert_to_units"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.convert_to_units">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;Meters&#39;</span><span class="p">,</span> <span class="n">starting_units</span><span class="o">=</span><span class="s1">&#39;Meters&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert all of the geometry in this ElectricalNetwork to certain units.</span>

<span class="sd">        Args:</span>
<span class="sd">            units: Text for the units to which the Model geometry should be</span>
<span class="sd">                converted. (Default: Meters). Choose from the following:</span>

<span class="sd">                * Meters</span>
<span class="sd">                * Millimeters</span>
<span class="sd">                * Feet</span>
<span class="sd">                * Inches</span>
<span class="sd">                * Centimeters</span>

<span class="sd">            starting_units: The starting units system of the network. (Default: Meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">starting_units</span> <span class="o">!=</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">scale_fac1</span> <span class="o">=</span> <span class="n">conversion_factor_to_meters</span><span class="p">(</span><span class="n">starting_units</span><span class="p">)</span>
            <span class="n">scale_fac2</span> <span class="o">=</span> <span class="n">conversion_factor_to_meters</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
            <span class="n">scale_fac</span> <span class="o">=</span> <span class="n">scale_fac1</span> <span class="o">/</span> <span class="n">scale_fac2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale_fac</span><span class="p">)</span></div>

<div class="viewcode-block" id="ElectricalNetwork.to_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;ElectricalNetwork dictionary representation.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ElectricalNetwork&#39;</span><span class="p">}</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;substation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;transformers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">trans</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">trans</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">]</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;connectors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">]</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;transformer_properties&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_properties</span><span class="p">]</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;power_lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">pl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_lines</span><span class="p">]</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;wires&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span>
        <span class="k">return</span> <span class="n">base</span></div>

<div class="viewcode-block" id="ElectricalNetwork.to_geojson_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.to_geojson_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_geojson_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buildings</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="n">Point2D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get ElectricalNetwork dictionary as it appears in an URBANopt geoJSON.</span>

<span class="sd">        The resulting dictionary array can be directly appended to the &quot;features&quot;</span>
<span class="sd">        key of a base geoJSON dict in order to represent the network in the</span>
<span class="sd">        geoJSON. Note that, in order to successfully run OpenDSS, you will also</span>
<span class="sd">        have to write an electrical_database.json from this ElectricalNetwork using</span>
<span class="sd">        the to_electrical_database_dict method.</span>

<span class="sd">        Args:</span>
<span class="sd">            buildings: An array of Dragonfly Building objects in the same units</span>
<span class="sd">                system as the ElectricalNetwork geometry.</span>
<span class="sd">            location: A ladybug Location object possessing longitude and latitude data.</span>
<span class="sd">            point: A ladybug_geometry Point2D for where the location object exists</span>
<span class="sd">                within the space of a scene. The coordinates of this point are</span>
<span class="sd">                expected to be in the units of this Model. (Default: (0, 0)).</span>
<span class="sd">            tolerance: The minimum difference between the coordinate values of two</span>
<span class="sd">                geometries at which they are considered co-located. (Default: 0.01,</span>
<span class="sd">                suitable for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the conversion factors over to (longitude, latitude)</span>
        <span class="n">origin_lon_lat</span> <span class="o">=</span> <span class="n">origin_long_lat_from_location</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
        <span class="n">convert_facs</span> <span class="o">=</span> <span class="n">meters_to_long_lat_factors</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">)</span>

        <span class="c1"># translate substation and transformers into the geoJSON features list</span>
        <span class="n">features_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="o">.</span><span class="n">to_geojson_dict</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">trans</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">:</span>
            <span class="n">features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">to_geojson_dict</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">))</span>

        <span class="c1"># translate connectors and junctions into the geoJSON features list</span>
        <span class="n">junctions</span><span class="p">,</span> <span class="n">connector_jct_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">junctions</span><span class="p">(</span><span class="n">tolerance</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">conn</span><span class="p">,</span> <span class="n">jct_ids</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">,</span> <span class="n">connector_jct_ids</span><span class="p">):</span>
            <span class="n">conn_dict</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">to_geojson_dict</span><span class="p">(</span>
                <span class="n">jct_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">jct_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">)</span>
            <span class="n">features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">conn_dict</span><span class="p">)</span>
        <span class="n">final_junctions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_junction_buildings</span><span class="p">(</span><span class="n">junctions</span><span class="p">,</span> <span class="n">buildings</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">jct</span> <span class="ow">in</span> <span class="n">final_junctions</span><span class="p">:</span>
            <span class="n">features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jct</span><span class="o">.</span><span class="n">to_geojson_dict</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">features_list</span></div>

<div class="viewcode-block" id="ElectricalNetwork.to_electrical_database_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.to_electrical_database_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_electrical_database_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get ElectricalNetwork as it should appear in the electrical_database.json.&quot;&quot;&quot;</span>
        <span class="n">catalog_json</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;lib&#39;</span><span class="p">,</span> <span class="s1">&#39;extended_catalog.json&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">catalog_json</span><span class="p">)</span> <span class="k">as</span> <span class="n">inf</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;SUBSTATIONS AND DISTRIBUTION TRANSFORMERS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;#Interurban:&#39;</span><span class="p">:</span>
                <span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">to_electrical_database_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_properties</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;LINES&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;#Interurban Zone A:&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">[</span><span class="n">pl</span><span class="o">.</span><span class="n">to_electrical_database_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">pl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">power_lines</span><span class="p">]</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;WIRES&#39;</span><span class="p">][</span><span class="s1">&#39;WIRES CATALOG&#39;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="p">[</span><span class="n">wire</span><span class="o">.</span><span class="n">to_electrical_database_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wires</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">base</span></div>

<div class="viewcode-block" id="ElectricalNetwork.duplicate"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.duplicate">[docs]</a>    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a copy of this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span></div>

<div class="viewcode-block" id="ElectricalNetwork.assign_junction_buildings"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.assign_junction_buildings">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">assign_junction_buildings</span><span class="p">(</span><span class="n">junctions</span><span class="p">,</span> <span class="n">buildings</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign building_identifiers to a list of junctions using dragonfly Buildings.</span>

<span class="sd">        Junctions will be assigned to a given Building if they are touching</span>
<span class="sd">        the footprint of that building in 2D space.</span>

<span class="sd">        Args:</span>
<span class="sd">            junctions: An array of ElectricalJunction objects to be associated</span>
<span class="sd">                with Dragonfly Buildings.</span>
<span class="sd">            buildings: An array of Dragonfly Building objects in the same units</span>
<span class="sd">                system as the ElectricalNetwork geometry.</span>
<span class="sd">            tolerance: The minimum difference between the coordinate values of two</span>
<span class="sd">                geometries at which they are considered co-located. (Default: 0.01,</span>
<span class="sd">                suitable for objects in meters).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the footprints of the Buildings in 2D space</span>
        <span class="n">footprint_2d</span><span class="p">,</span> <span class="n">bldg_ids</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">bldg</span> <span class="ow">in</span> <span class="n">buildings</span><span class="p">:</span>
            <span class="n">footprint</span> <span class="o">=</span> <span class="n">bldg</span><span class="o">.</span><span class="n">footprint</span><span class="p">(</span><span class="n">tolerance</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">face3d</span> <span class="ow">in</span> <span class="n">footprint</span><span class="p">:</span>
                <span class="n">pts_2d</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point2D</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">face3d</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
                <span class="n">footprint_2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Polygon2D</span><span class="p">(</span><span class="n">pts_2d</span><span class="p">))</span>
                <span class="n">bldg_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bldg</span><span class="o">.</span><span class="n">identifier</span><span class="p">)</span>

        <span class="c1"># loop through connectors and associate them with the Buildings</span>
        <span class="k">for</span> <span class="n">jct</span> <span class="ow">in</span> <span class="n">junctions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">bldg_poly</span><span class="p">,</span> <span class="n">bldg_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">footprint_2d</span><span class="p">,</span> <span class="n">bldg_ids</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bldg_poly</span><span class="o">.</span><span class="n">is_point_on_edge</span><span class="p">(</span><span class="n">jct</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">):</span>
                    <span class="n">jct</span><span class="o">.</span><span class="n">building_identifier</span> <span class="o">=</span> <span class="n">bldg_id</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">junctions</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_instance_in_array</span><span class="p">(</span><span class="n">object_instance</span><span class="p">,</span> <span class="n">object_array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a specific object instance is already in an array.</span>

<span class="sd">        This can be much faster than `if object_instance in object_array`</span>
<span class="sd">        when you expect to be testing a lot of the same instance of an object for</span>
<span class="sd">        inclusion in an array since the builtin method uses an == operator to</span>
<span class="sd">        test inclusion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">object_array</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="n">object_instance</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_net</span> <span class="o">=</span> <span class="n">ElectricalNetwork</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="o">.</span><span class="n">duplicate</span><span class="p">(),</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">trans</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span> <span class="k">for</span> <span class="n">trans</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformers</span><span class="p">),</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span> <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectors</span><span class="p">))</span>
        <span class="n">new_net</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span>
        <span class="k">return</span> <span class="n">new_net</span>

<div class="viewcode-block" id="ElectricalNetwork.ToString"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.ElectricalNetwork.ToString">[docs]</a>    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;ElectricalNetwork: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="RoadNetwork"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork">[docs]</a><span class="k">class</span> <span class="nc">RoadNetwork</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a road network for RNM input.</span>

<span class="sd">    This includes a substation and roads that will be used to lay out the</span>
<span class="sd">    road network.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifier: Text string for a unique road network ID. Must contain only</span>
<span class="sd">            characters that are acceptable in RNM nad OpenDSS. This will be used to</span>
<span class="sd">            identify the object across the exported geoJSON RNM, and OpenDSS files.</span>
<span class="sd">        substation: A Substation object representing the road substation</span>
<span class="sd">            supplying the network with electricity.</span>
<span class="sd">        roads: An array of Road objects that are included within the road network.</span>

<span class="sd">    Properties:</span>
<span class="sd">        * identifier</span>
<span class="sd">        * display_name</span>
<span class="sd">        * substation</span>
<span class="sd">        * roads</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;_display_name&#39;</span><span class="p">,</span> <span class="s1">&#39;_substation&#39;</span><span class="p">,</span> <span class="s1">&#39;_roads&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">substation</span><span class="p">,</span> <span class="n">roads</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize RoadNetwork.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substation</span> <span class="o">=</span> <span class="n">substation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roads</span> <span class="o">=</span> <span class="n">roads</span>

<div class="viewcode-block" id="RoadNetwork.from_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.from_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize an RoadNetwork from a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: A dictionary representation of an RoadNetwork object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check the type of dictionary</span>
        <span class="k">assert</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RoadNetwork&#39;</span><span class="p">,</span> <span class="s1">&#39;Expected RoadNetwork &#39;</span> \
            <span class="s1">&#39;dictionary. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="c1"># re-serialize geometry objects</span>
        <span class="n">substation</span> <span class="o">=</span> <span class="n">Substation</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;substation&#39;</span><span class="p">])</span>
        <span class="n">roads</span> <span class="o">=</span> <span class="p">[</span><span class="n">Road</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;roads&#39;</span><span class="p">]]</span>
        <span class="n">net</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">],</span> <span class="n">substation</span><span class="p">,</span> <span class="n">roads</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;display_name&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">net</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">net</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set the text string for unique object identifier.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>

    <span class="nd">@identifier</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">identifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span> <span class="o">=</span> <span class="n">valid_ep_string</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set a string for the object name without any character restrictions.</span>

<span class="sd">        If not set, this will be equal to the identifier.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span>

    <span class="nd">@display_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>  <span class="c1"># Python 2 machine lacking the character set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="n">value</span>  <span class="c1"># keep it as unicode</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">substation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set a Substation object for the network&#39;s substation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span>

    <span class="nd">@substation</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">substation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Substation</span><span class="p">),</span> \
            <span class="s1">&#39;Expected Substation for road network. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">roads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get or set the list of Road objects within the network.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_roads</span>

    <span class="nd">@roads</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">roads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected list or tuple of roads. &#39;</span>
                            <span class="s1">&#39;Got </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Road</span><span class="p">),</span> <span class="s1">&#39;Expected Road &#39;</span> \
                <span class="s1">&#39;object for road network. Got </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;RoadNetwork must possess at least one road.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_roads</span> <span class="o">=</span> <span class="n">values</span>

<div class="viewcode-block" id="RoadNetwork.move"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">moving_vec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move this object along a vector.</span>

<span class="sd">        Args:</span>
<span class="sd">            moving_vec: A ladybug_geometry Vector3D with the direction and distance</span>
<span class="sd">                to move the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moving_vec</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">road</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">:</span>
            <span class="n">road</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moving_vec</span><span class="p">)</span></div>

<div class="viewcode-block" id="RoadNetwork.rotate_xy"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.rotate_xy">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rotate this object counterclockwise in the XY plane by a certain angle.</span>

<span class="sd">        Args:</span>
<span class="sd">            angle: An angle in degrees.</span>
<span class="sd">            origin: A ladybug_geometry Point3D for the origin around which the</span>
<span class="sd">                object will be rotated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">road</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">:</span>
            <span class="n">road</span><span class="o">.</span><span class="n">rotate_xy</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span></div>

<div class="viewcode-block" id="RoadNetwork.reflect"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.reflect">[docs]</a>    <span class="k">def</span> <span class="nf">reflect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plane</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reflect this object across a plane.</span>

<span class="sd">        Args:</span>
<span class="sd">            plane: A ladybug_geometry Plane across which the object will be reflected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">plane</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">road</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">:</span>
            <span class="n">road</span><span class="o">.</span><span class="n">reflect</span><span class="p">(</span><span class="n">plane</span><span class="p">)</span></div>

<div class="viewcode-block" id="RoadNetwork.scale"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scale this object by a factor from an origin point.</span>

<span class="sd">        Args:</span>
<span class="sd">            factor: A number representing how much the object should be scaled.</span>
<span class="sd">            origin: A ladybug_geometry Point3D representing the origin from which</span>
<span class="sd">                to scale. If None, it will be scaled from the World origin (0, 0, 0).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substation</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">road</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">:</span>
            <span class="n">road</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">factor</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span></div>

<div class="viewcode-block" id="RoadNetwork.to_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;RoadNetwork dictionary representation.&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RoadNetwork&#39;</span><span class="p">}</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;substation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">base</span><span class="p">[</span><span class="s1">&#39;roads&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span><span class="p">[</span><span class="s1">&#39;display_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span>
        <span class="k">return</span> <span class="n">base</span></div>

<div class="viewcode-block" id="RoadNetwork.to_geojson_dict"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.to_geojson_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_geojson_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="n">Point2D</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get RoadNetwork dictionary as it appears in an URBANopt geoJSON.</span>

<span class="sd">        The resulting dictionary array can be directly appended to the &quot;features&quot;</span>
<span class="sd">        key of a base geoJSON dict in order to represent the network in the</span>
<span class="sd">        geoJSON.</span>

<span class="sd">        Args:</span>
<span class="sd">            location: A ladybug Location object possessing longitude and latitude data.</span>
<span class="sd">            point: A ladybug_geometry Point2D for where the location object exists</span>
<span class="sd">                within the space of a scene. The coordinates of this point are</span>
<span class="sd">                expected to be in the units of this Model. (Default: (0, 0)).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get the conversion factors over to (longitude, latitude)</span>
        <span class="n">origin_lon_lat</span> <span class="o">=</span> <span class="n">origin_long_lat_from_location</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
        <span class="n">convert_facs</span> <span class="o">=</span> <span class="n">meters_to_long_lat_factors</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">)</span>

        <span class="c1"># translate substation and transformers into the geoJSON features list</span>
        <span class="n">features_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="o">.</span><span class="n">to_geojson_dict</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">road</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">:</span>
            <span class="n">features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">road</span><span class="o">.</span><span class="n">to_geojson_dict</span><span class="p">(</span><span class="n">origin_lon_lat</span><span class="p">,</span> <span class="n">convert_facs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">features_list</span></div>

<div class="viewcode-block" id="RoadNetwork.duplicate"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.duplicate">[docs]</a>    <span class="k">def</span> <span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a copy of this object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_net</span> <span class="o">=</span> <span class="n">RoadNetwork</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">substation</span><span class="o">.</span><span class="n">duplicate</span><span class="p">(),</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">roads</span><span class="p">))</span>
        <span class="n">new_net</span><span class="o">.</span><span class="n">_display_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_display_name</span>
        <span class="k">return</span> <span class="n">new_net</span>

<div class="viewcode-block" id="RoadNetwork.ToString"><a class="viewcode-back" href="../../../dragonfly_energy.opendss.network.html#dragonfly_energy.opendss.network.RoadNetwork.ToString">[docs]</a>    <span class="k">def</span> <span class="nf">ToString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;RoadNetwork: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display_name</span><span class="p">)</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, Ladybug Tools.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>